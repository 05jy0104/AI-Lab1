# Resolution Theorem Prover - 一阶逻辑推理系统

## 📖 项目简介

这是一个基于 Two-Pointer Resolution 算法的定理证明器，能够解决一阶逻辑问题。系统实现了完整的归结推理过程，包括合一算法、变量标准化、重言式检测等核心功能。

## 🚀 功能特性

### 核心算法
- ✅ **Two-Pointer Resolution** - 优化的归结推理算法
- ✅ **合一算法** - 支持变量、常量、函数的合一
- ✅ **变量标准化** - 自动处理变量重命名
- ✅ **重言式检测** - 自动跳过重言式子句
- ✅ **推理历史记录** - 完整记录每一步推理过程

### 问题求解
- ✅ **Howling Hounds 问题** - 完整的逻辑推理证明
- ✅ **Drug Dealer 问题** - 复杂逻辑关系推理
- ✅ **简单测试用例** - 基础功能验证

### 用户体验
- ✅ **交互式菜单** - 友好的命令行界面
- ✅ **步骤显示控制** - 可选择是否显示详细推理步骤
- ✅ **性能统计** - 实时显示推理步数和耗时
- ✅ **结果可视化** - 清晰的证明状态显示

## 📁 项目结构

```
resolution_prover/
├── 📊 核心算法模块
│   ├── clause.py           # 数据结构定义（Term, Literal, Clause）
│   ├── unification.py      # 合一算法实现
│   ├── resolution.py       # 归结推理核心算法
│   └── __init__.py         # 包初始化文件
│
├── 🔧 系统功能模块
│   ├── problems.py         # 问题子句定义与建模
│   ├── main.py             # 主程序入口
│   ├── test_resolution.py  # 单元测试套件
│   └── experiment_log.py   # 实验过程记录系统
│
└── 🧪 测试与验证
    ├── check_basic.py      # 基础功能测试
    └── check_algorithms.py # 算法逻辑测试
```

## 🛠️ 安装与运行

### 环境要求
- Python 3.6 或更高版本
- 无需额外依赖库

### 快速开始

1. **下载项目代码**
```bash
git clone <repository-url>
cd resolution_prover
```

2. **测试基础功能**
```bash
python check_basic.py
python check_algorithms.py
```

3. **运行主程序**
```bash
python main.py
```

## 🎯 使用指南

### 主菜单选项

运行 `main.py` 后，系统提供以下选项：

1. **Howling Hounds 问题** - 解决猎犬嚎叫逻辑问题
2. **Drug Dealer 问题** - 解决毒贩与海关官员逻辑问题  
3. **简单测试用例** - 运行基础矛盾测试
4. **合一算法演示** - 展示合一算法功能
5. **运行所有优化问题** - 批量运行所有问题
6. **退出** - 退出程序

### 推理步骤显示

在运行任何问题时，系统会询问：
```
是否显示详细推理步骤？(y/n):
```

- **输入 y**：显示所有详细的推理步骤，包括：
  - 每一步的归结对
  - 使用的文字和替换
  - 生成的归结子句
  - 重要推理步骤的高亮显示

- **输入 n**：只显示最终结果和统计信息，适合快速验证

### 输出示例

```
==============================================
开始解决 Howling Hounds 问题
==============================================

初始子句集 (6 个子句):
 1. ¬Hound(x) ∨ Howl(x)
 2. ¬LightSleeper(x) ∨ ¬Has(x,y) ∨ ¬Howl(y)
 3. LightSleeper(John)
 4. Has(John,a)
 5. Hound(a)
 6. HasMouse(John)

开始归结推理...

🎉 找到矛盾！在第 15 步推导出空子句

==============================================
✅ Howling Hounds: 定理得证！
==============================================

推理统计:
总推理步数: 15
总生成子句数: 23
推理耗时: 0.045秒
是否找到空子句: True

🎉 性能优秀：在100步内完成！
```

## 🔍 问题描述

### 1. Howling Hounds 问题

**已知条件：**
1. 所有猎犬晚上都会嚎叫
2. 养猫的人不会有老鼠
3. 浅眠者没有会嚎叫的动物
4. John 要么养猫要么养猎犬

**要证明的结论：**
如果 John 是浅眠者，那么 John 没有老鼠

### 2. Drug Dealer 问题

**已知条件：**
1. 海关官员会搜查所有进入国家的非VIP人员
2. 有些毒贩进入了国家，且他们只被毒贩搜查
3. 没有毒贩是VIP
4. 有些海关官员是毒贩

**逻辑推理：**
从上述条件推导出存在既是海关官员又是毒贩的人

## 🧪 测试验证

系统提供完整的测试套件：

```bash
# 运行全面测试
python test_resolution.py

# 快速功能测试
python test_resolution.py quick

# 基础模块测试
python check_basic.py
python check_algorithms.py
```

## 📊 性能优化

### 算法优化
- **最大步数限制**：2000步，防止无限循环
- **重复子句检测**：使用集合快速去重
- **重言式跳过**：自动识别并跳过重言式
- **谓词快速检查**：提前过滤不可能归结的子句对

### 内存管理
- **变量标准化**：避免变量名冲突
- **深拷贝控制**：只在必要时创建副本
- **历史记录优化**：只记录重要推理步骤

## 🔧 扩展开发

### 添加新问题

在 `problems.py` 中添加新的问题构建方法：

```python
@staticmethod
def create_custom_problem():
    clauses = []
    # 添加子句定义
    clauses.append(Clause([Literal("P", [x])]))
    # ... 更多子句
    return clauses
```

然后在 `get_all_problems()` 中注册新问题。

### 修改推理参数

在 `resolution.py` 的 `ResolutionProver` 类中：
- `max_steps`: 修改最大推理步数
- `show_detailed_steps`: 控制默认是否显示步骤

## 📈 性能基准

在标准测试环境下：
- **简单矛盾**：1-2步，<0.01秒
- **Howling Hounds**：10-20步，<0.1秒  
- **Drug Dealer**：50-100步，<0.5秒
- **复杂问题**：<2000步，<5秒

## 🐛 故障排除

### 常见问题

1. **推理卡住**
   - 检查问题建模是否正确
   - 确认没有循环依赖
   - 尝试增加 `max_steps` 参数

2. **合一失败**
   - 验证变量标准化
   - 检查函数参数匹配
   - 确认谓词名称一致

3. **内存不足**
   - 减少 `max_steps` 限制
   - 启用重言式检测
   - 优化子句去重逻辑

### 调试技巧

启用详细步骤显示来分析推理过程：
```python
prover.show_detailed_steps = True
result = prover.two_pointer_resolution()
```

## 📄 许可证

本项目仅供学术研究和教育使用。

## 👥 贡献指南

欢迎提交 Issue 和 Pull Request 来改进项目。

## 📞 支持联系

如有问题请通过以下方式联系：
- 提交 GitHub Issue
- 发送邮件至项目维护者

---

**最后更新**: 2025-10-29  
**版本**: 1.2.1  